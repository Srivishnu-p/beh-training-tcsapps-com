import pandas as pd

def read_ips_from_file(filename):
    """Read IPs from a file and return them as a set."""
    with open(filename, 'r') as file:
        content = file.read()
        # Split by comma and remove any whitespace
        ips = [ip.strip() for ip in content.split(',') if ip.strip()]
        return set(ips)

def find_missing_ips(target_file, apply_file):
    """Find IPs in target_file that are not in apply_file."""
    target_ips = read_ips_from_file(target_file)
    apply_ips = read_ips_from_file(apply_file)

    # Find IPs in target_file that are not in apply_file
    missing_ips = target_ips - apply_ips
    return missing_ips

def save_to_excel(missing_ips, output_file):
    """Save missing IPs to an Excel file with two columns."""
    # Create a DataFrame with missing IPs and an empty second column
    df = pd.DataFrame({
        'Missing IPs (Target)': list(missing_ips),
        'Placeholder': [''] * len(missing_ips)  # Empty second column
    })

    # Save to Excel or CSV
    if output_file.endswith('.xlsx'):
        df.to_excel(output_file, index=False)
    elif output_file.endswith('.csv'):
        df.to_csv(output_file, index=False)
    else:
        raise ValueError("Output file must be .xlsx or .csv")

if _name_ == "_main_":
    # File names
    target_file = 'target.txt'  # Replace with your target file name
    apply_file = 'apply.txt'    # Replace with your apply file name
    output_file = 'output.xlsx' # Output file name (can also be .csv)

    # Find missing IPs
    missing_ips = find_missing_ips(target_file, apply_file)

    # Save to Excel or CSV
    save_to_excel(missing_ips, output_file)

    print(f"Missing IPs have been saved to {output_file}")
